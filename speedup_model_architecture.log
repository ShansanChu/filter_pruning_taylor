2021-01-07 14:47:59,953 : INFO : Taylor_Pruner_Debug : for batch size 64 and with 32 runs, the elapsed time is 1.7011628150939941
2021-01-07 14:48:00,252 : INFO : Taylor_Pruner_Debug : flops and parameters before speedup is 4111515624.0 FLOPS and 25557032.0 params
2021-01-07 14:48:06,285 : INFO : Taylor_Pruner_Debug : elasped time with batch_size 64 and in 32 runs is 1.3822903633117676
2021-01-07 14:48:06,285 : INFO : Taylor_Pruner_Debug : model structure after speedup is ====
2021-01-07 14:48:06,285 : INFO : Taylor_Pruner_Debug : ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(64, 46, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(46, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(46, 44, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(44, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(44, 253, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(253, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(64, 253, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): BatchNorm2d(253, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(253, 49, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(49, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(49, 52, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(52, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(52, 253, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(253, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(253, 44, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(44, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(44, 59, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(59, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(59, 253, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(253, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
  )
  (layer2): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(253, 107, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(107, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(107, 120, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(120, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(120, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(253, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(512, 50, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(50, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(50, 72, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(72, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(72, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(512, 87, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(87, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(87, 100, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(100, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (3): Bottleneck(
      (conv1): Conv2d(512, 89, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(89, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(89, 101, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(101, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(101, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
  )
  (layer3): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(512, 247, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(247, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(247, 220, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(220, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(220, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(1024, 140, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(140, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(140, 164, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(164, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(164, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(1024, 127, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(127, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(127, 162, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(162, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(162, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (3): Bottleneck(
      (conv1): Conv2d(1024, 147, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(147, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(147, 139, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(139, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(139, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (4): Bottleneck(
      (conv1): Conv2d(1024, 147, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(147, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(147, 149, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(149, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(149, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (5): Bottleneck(
      (conv1): Conv2d(1024, 181, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(181, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(181, 182, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(182, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(182, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
  )
  (layer4): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(1024, 478, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(478, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(478, 424, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(424, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(424, 1863, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1863, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(1024, 1863, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(1863, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(1863, 405, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(405, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(405, 400, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(400, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(400, 1863, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1863, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(1863, 451, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(451, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(451, 357, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(357, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(357, 1863, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1863, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=1863, out_features=1000, bias=True)
)
2021-01-07 14:48:06,523 : INFO : Taylor_Pruner_Debug : After speedup flops are 2742625738.0 and number of parameters are 17780626.0

2021-01-07 14:54:02,092 : INFO : Taylor_Pruner_Debug : for batch size 64 and with 32 runs, the elapsed time is 1.7071306705474854
2021-01-07 14:54:02,392 : INFO : Taylor_Pruner_Debug : flops and parameters before speedup is 4111515624.0 FLOPS and 25557032.0 params
2021-01-07 14:54:08,609 : INFO : Taylor_Pruner_Debug : elasped time with batch_size 64 and in 32 runs is 1.443481683731079
2021-01-07 14:54:08,610 : INFO : Taylor_Pruner_Debug : model structure after speedup is ====
2021-01-07 14:54:08,610 : INFO : Taylor_Pruner_Debug : ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(64, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(48, 46, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(46, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(46, 253, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(253, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(64, 253, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): BatchNorm2d(253, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(253, 50, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(50, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(50, 56, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(56, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(56, 253, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(253, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(253, 49, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(49, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(49, 62, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(62, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(62, 253, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(253, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
  )
  (layer2): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(253, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(112, 121, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(121, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(121, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(253, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(512, 56, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(56, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(56, 79, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(79, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(79, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(512, 94, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(94, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(94, 103, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(103, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(103, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (3): Bottleneck(
      (conv1): Conv2d(512, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(96, 102, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(102, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(102, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
  )
  (layer3): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(512, 249, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(249, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(249, 233, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(233, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(233, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(1024, 155, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(155, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(155, 182, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(182, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(182, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(1024, 138, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(138, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(138, 166, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(166, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(166, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (3): Bottleneck(
      (conv1): Conv2d(1024, 163, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(163, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(163, 156, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(156, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(156, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (4): Bottleneck(
      (conv1): Conv2d(1024, 157, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(157, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(157, 161, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(161, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(161, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (5): Bottleneck(
      (conv1): Conv2d(1024, 199, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(199, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(199, 202, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(202, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(202, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
  )
  (layer4): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(1024, 493, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(493, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(493, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(448, 1890, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1890, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(1024, 1890, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(1890, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(1890, 456, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(456, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(456, 435, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(435, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(435, 1890, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1890, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(1890, 477, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(477, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(477, 391, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(391, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(391, 1890, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1890, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (relu1): ReLU(inplace=True)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=1890, out_features=1000, bias=True)
)
2021-01-07 14:54:08,858 : INFO : Taylor_Pruner_Debug : After speedup flops are 2957512179.0 and number of parameters are 19408464.0
